function setCookie(name,value,expiresDay){const d=new Date();d.setTime(d.getTime()+(expiresDay*24*60*60*1000));let expires="expires="+d.toUTCString();document.cookie=name+"="+value+";"+expires+";path=/"}function getCookie(name){let cookieName=name+"=";let ca=document.cookie.split(";");for(let i=0;i<ca.length;i++){let c=ca[i];while(c.charAt(0)===" "){c=c.substring(1)}if(c.indexOf(cookieName)===0){return c.substring(cookieName.length,c.length)}}return""}function showMessage(messageHTML){$("#output").append(messageHTML)}function handleChat(){let webSocket=new WebSocket("ws://0.0.0.0:9090");webSocket.onopen=function(event){showMessage("<small class='text-success'>Successfully entered the room...</small>")};webSocket.onmessage=function(event){let data=JSON.parse(event.data);showMessage("<p>"+data.message+"</p>");$("#message").val("")};webSocket.onerror=function(event){showMessage("<small class='text-danger'>Problem due to some Error!</p>")};webSocket.onclose=function(event){showMessage("<small class='text-success'>Connection Closed</small>")};$("#chat-submit").on("click",function(event){event.preventDefault();let messageJSON={name:$("#client-name").val(),message:$("#message").val()};webSocket.send(JSON.stringify(messageJSON))})}$(document).ready(function(){const summernoteBody=$("#body");if(summernoteBody.length){summernoteBody.summernote({tabsize:4,height:100})}const toastElement=$(".toast");toastElement.toast({delay:4000});const message=getCookie("message");if(message!==""){toastElement.toast("show");$(".toast-body").text(decodeURI(message))}$(function(){$("[data-toggle='tooltip']").tooltip()});const body=$("body");body.on("click",".form-button",function(event){let elementId=$(this).attr("id");elementId=elementId.replace("-submit","");let formData=new FormData($("form").get(0));$.ajax({url:apiAddress+"/"+elementId.replace("-","/"),data:formData,type:"POST",dataType:"JSON",cache:false,processData:false,contentType:false,beforeSend(){$(".progress").css("top","56px")},complete(){$(".progress").css("top","51px")},success(result){if(result.status==="OK"){window.location.replace("/")}else{toastElement.toast("show");$(".toast-body").text(result.message)}},error(xhr,status,error){toastElement.toast("show");let message="Unknown Error!";if(typeof result==="undefined"){message="DB connection error! Please try again."}else{message=result.message}$(".toast-body").text(message)}})});body.on("keypress","form",function(event){if(event.key==="Enter")$(".form-button").click()});body.on("click",".form-delete-button",function(event){let elementId=$(this).attr("id");$.ajax({url:apiAddress+"/blog/delete/"+elementId,type:"DELETE",dataType:"JSON",beforeSend(){$(".progress").css("top","56px")},complete(){$(".progress").css("top","51px")},success(result){if(result.status==="OK"){window.location.replace("/")}else{toastElement.toast("show");$(".toast-body").text(result.message)}},error(xhr,status,error){toastElement.toast("show");let message="Unknown Error!";if(typeof result==="undefined"){message="DB connection error! Please try again."}else{message=result.message}$(".toast-body").text(message)}})});if(window.location.pathname==="/websocket"){handleChat()}});